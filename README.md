# CICC2623-
<p>在本次芯来杯赛中我小组完成了一款在视频图像领域中对运动轨迹跟踪和加密传输的SOC系统。此系统可完成对图像中运动目标的实时监测，并返回带目标检测的视频图像。同时通过国密SM4算法加密其坐标，最后传输至上位机实时追踪运动目标的运动轨迹。</p>
<p>针对赛题要求在对E203内核做了初步性能分析后发现，取指效率和指令执行周期数构成了E203内核的性能瓶颈。为了提高取指效率，我们将原本准确率有限的静态分支预测器修改为了基于全局历史的动态分支预测器，同时为了减少多周期运算指令的执行周期，我们在不降低主频的前提下设计了一款高性能乘除法器。经过FPGA实测，改进的E203在取指效率比改进前提升了50%,多周期运算指令执行周期数平均提升了13倍。最终在嵌入式基准程序实测中跑分为：</p>
1）Coremark得分为3.267794 CoreMark/MHz，相比baseline提升1.5倍。<br>
2）Dhrystone得分为4.661278 DMIPS/MHz , 相比baseline提升3.6倍。<br>
3）Whetstone得分为0.125 MWIPS/MHz，相比baseline提升3.1倍。<br>
<p>由于基础RISC-V指令集中执行SM4国密算法需要进行大量的异或、移位以及盒变换等操作，使得基础E203内核若要执行SM4算法需要耗费大量的逻辑运算和移位指令数以及相当大功耗和执行周期数。因此我们在E203内核中添加了SM4算法的加解密相关的扩展指令，并在NICE协处理器接口上添加SM4加解密硬件加速电路来完成算法的硬件加速。经过实测添加了扩展指令的E203内核在执行SM4国密算法时相较于纯软件实现SM4国密算子，扩展硬件算子的指令数减少了530倍，消耗的指令周期数减少了168倍。</p>
<p>为减轻E203内核在图像视频中的运算量，我团队在SOC外设系统中设计了一款ImagePocessUnit（IPU，图像处理加速器）。来加速处理系统中的图像信号。加速器中集成了接收图像，处理图像，输出图像的功能。其工作流程为：摄像头先将视频数据传输到IPU，IPU会对摄像头视野中的运动目标进行检测，并在HDMI显示器上显示摄像头的实时监控画面，并用红框标记出运动目标的位置。并把其位置坐标传入E203内核。E203会将运动目标的坐标位置实时加密，并通过串口发送给上位机。</p>
<p>上位机由我团队用高级语言编写，上位机会实时对加密坐标进行解密，并将解密的坐标位置动态地显示在上位机的坐标区域中。并提供API供上层应用调用完成更多复杂的应用。<br>
我们基于Xlinx平台建立了硬件测试平台，完成了SOC系统的板级验证。也通过VCS、Modelsim等仿真平台对硬件加速电路， E203内核都进行了单元级别，系统级别的功能验证，并尝试了敏捷开发的设计模式。通过FPGA综合结果可知在此设计可工作在E203内核的官方推荐频率下（16Mhz），并在面积和功耗上均满足赛题给定的设计要求。</p>
